<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Java - Developer Portal</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../iconmoon.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Developer Portal</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Back End <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Back End/Code Style Guide/">Code Style Guide</a>
</li>

                        
                            
<li >
    <a href="../../Back End/Models/">Models</a>
</li>

                        
                            
<li >
    <a href="../../Back End/Scripting/">Scripting</a>
</li>

                        
                            
<li >
    <a href="../../Back End/Templates/">Templates</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Front End <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Front End/Helpers/">Helpers</a>
</li>

                        
                            
<li >
    <a href="../../Front End/Plugins/">Plugins</a>
</li>

                        
                            
<li >
    <a href="../../Front End/Themes/">Themes</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">References <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../References/Deploying/">Deploying</a>
</li>

                        
                            
<li >
    <a href="../../References/Document Properties/">Document Properties</a>
</li>

                        
                            
<li >
    <a href="../../References/Javadocs/">Javadocs</a>
</li>

                        
                            
<li >
    <a href="../../References/PQL/">PQL</a>
</li>

                        
                            
<li >
    <a href="../../References/esdoc/">Esdoc</a>
</li>

                        
                            
<li >
    <a href="../../References/tools/">Tools</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Remote <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../API Explorer/">API Explorer</a>
</li>

                        
                            
<li >
    <a href="../Browser/">Browser</a>
</li>

                        
                            
<li >
    <a href="../DOT Net/">DOT Net</a>
</li>

                        
                            
<li >
    <a href="../HTTP Public API/">HTTP Public API</a>
</li>

                        
                            
<li class="active">
    <a href="./">Java</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Esign <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../esign/api/">Api</a>
</li>

                        
                            
<li >
    <a href="../../esign/development/">Development</a>
</li>

                        
                            
<li >
    <a href="../../esign/scripting/">Scripting</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Workflow <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../workflow/getting-started/">Getting started</a>
</li>

                        
                            
<li >
    <a href="../../workflow/troubleshooting/">Troubleshooting</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../HTTP Public API/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../esign/api/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#full-remoting-client">Full Remoting Client</a></li>
        
            <li><a href="#install-the-full-remoting-client">Install the full remoting client</a></li>
        
            <li><a href="#initializing-a-remote-session">Initializing a Remote Session</a></li>
        
            <li><a href="#using-a-remote-session">Using a Remote Session</a></li>
        
    
        <li class="main "><a href="#lightweight-remoting-client">Lightweight Remoting Client</a></li>
        
            <li><a href="#initializing-the-papertrail-client">Initializing the PaperTrail client</a></li>
        
            <li><a href="#importing-a-document">Importing a document</a></li>
        
            <li><a href="#getting-a-document-from-papertrail">Getting a document from Papertrail</a></li>
        
            <li><a href="#updating-document-metatdataindexes">Updating document metatdata/indexes</a></li>
        
            <li><a href="#searching-for-documents">Searching for documents</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="full-remoting-client">Full Remoting Client</h2>
<p>The full remoting client provides the same interfaces used for scripting within PaperTrail. The provides the advantage of having the same code being able to used within workflows and scripts, and from 3rd party apps. This however does come at a cost of a large number of dependencies.</p>
<h3 id="install-the-full-remoting-client">Install the full remoting client</h3>
<p>The easiesy way of using the remoting client is with <a href="../github.com/egis/gradle-build">gradle-build</a> and a</p>
<p><code>lib.txt</code> containing the following:</p>
<pre><code>commons.txt
papertrail-api.txt
</code></pre>
<p>and a <code>build.gradle</code> containing:</p>
<pre><code>buildscript {
    repositories {
        jcenter()
        mavenCentral()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
         classpath 'org.codehaus.groovy:groovy-all:2.4.4'
        classpath "gradle.plugin.com.egis:gradle-build:2.7"
    }
}

ext {
    pkg = 'papetrail-remote-client'
    libBucket = 'papertrail'
    libPrefix = "libs/"
}

apply plugin: 'idea'
apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: "com.egis.gradle"
</code></pre>
<h3 id="initializing-a-remote-session">Initializing a Remote Session</h3>
<pre><code class="java">//configure logging levels to reduce console spam
Utils.setLogLevel(&quot;org.apache&quot;, &quot;INFO&quot;)
Utils.setLogLevel(&quot;com.egis&quot;, &quot;INFO&quot;)
Utils.setLogLevel(&quot;com.egis.DocumentLogger&quot;, &quot;DEBUG&quot;)
Utils.setLogLevel(&quot;com.egis.remote&quot;, &quot;DEBUG&quot;)
Utils.setLogLevel(&quot;com.egis.utils.http.GET&quot;, &quot;INFO&quot;)
Utils.setLogLevel(&quot;com.egis.utils.http.POST&quot;, &quot;INFO&quot;)
Utils.setLogLevel(&quot;com.zaxxer&quot;, &quot;INFO&quot;)

//use default host settings or retrieve from environment variables
String host = Utils.def(System.getenv(&quot;PT_API&quot;), &quot;http://localhost:8080&quot;);
String user = Utils.def(System.getenv(&quot;PT_API_USER&quot;), &quot;admin&quot;);
String pass = Utils.def(System.getenv(&quot;PT_API_PASS&quot;), &quot;p&quot;);
if (!host.startsWith(&quot;http&quot;)) {
    host = &quot;http://&quot; + host;
}

//create the session and make it available via Kernel.get(Session.class)
Session session = new RemoteSessionImpl(host, user, pass);
Kernel.bind(Session.class).toSingleton(session)

</code></pre>

<h3 id="using-a-remote-session">Using a Remote Session</h3>
<p>Once a remote session is initialized it can be used in the same way the (<a href="http://egis.github.io/PT/com/egis/Session.html">Session</a> and <a href="http://egis.github.io/PT/com/egis/DocumentModel.html">DocumentModel</a>) are used for <a href="../scripting">scripting</a></p>
<blockquote>
<p>&amp;icon-badge-exclamation:4x:green; Not all methods are supported for remote use, those that don't will throw an IllegalStateException</p>
</blockquote>
<h2 id="lightweight-remoting-client">Lightweight Remoting Client</h2>
<p><a href="../PaperTrail-API-1.5.jar">PaperTrail-API-1.5.jar</a> is a lightweight dependency free PaperTrail client suitable for embedding into opther applications </p>
<h3 id="initializing-the-papertrail-client">Initializing the PaperTrail client</h3>
<pre><code class="java">String host = &quot;http://hostname:8080&quot;;
String user = &quot;admin&quot;;
String password = &quot;password&quot;;
PaperTrail client = new PaperTrail(host, user, password);
</code></pre>

<h3 id="importing-a-document">Importing a document</h3>
<pre><code class="java">File file = new File(&quot;test.doc&quot;);
String node = &quot;TestDivision/Cabinet/Folder1&quot;;
Map&lt;String,String&gt; indexes = new HashMap&lt;String,String&gt;();
indexes.put(&quot;customIndex1&quot;, &quot;value1&quot;);
indexes.put(&quot;customIndex2&quot;, &quot;value2&quot;);
String docId = client.importDocument(file, node, indexes);
</code></pre>

<h3 id="getting-a-document-from-papertrail">Getting a document from Papertrail</h3>
<pre><code class="java">InputStream stream = client.getDocument(docId);
Getting the metadata for a Document.
Document document = client.getDocumentMetadata(docId);
System.out.println(document.getTitle());
System.out.println(document.getIndexes().get(&quot;customIndex1&quot;);
Checking out a document:
client.checkout(docId);
Checking in a document:
File file = new File(&quot;test-0.2.doc&quot;);
String version = &quot;0.2&quot;;
String comments = &quot;just some minor updates to the document&quot;;
client.checkin(docId, file, version, comments);
</code></pre>

<h3 id="updating-document-metatdataindexes">Updating document metatdata/indexes</h3>
<pre><code class="java">Map&lt;String,String&gt; indexes = new HashMap&lt;String,String&gt;();
indexes.put(&quot;customIndex1&quot;, &quot;value1_update&quot;);
indexes.put(&quot;customIndex2&quot;, &quot;value2_update&quot;);
client.updateMetadata(docId, indexes);
</code></pre>

<p>All actions internally map to execute method calls, so checkout is equivalent to:
client.execute("checkout", docId, null);
Only a few of the standard actions have been implemented in the Java Wrapper, they rest can be called using the execute method, see </p>
<h3 id="searching-for-documents">Searching for documents</h3>
<pre><code class="java">String query =
String columns = ;
QueryResults results = client.query(&quot;TestDivision/Cabinet/*&quot;)
    .column(&quot;docId&quot;,&quot;filename&quot;,&quot;title&quot;,&quot;subject&quot;,&quot;createdDate&quot;,&quot;createdBy&quot;)
    .execute();
System.out.println(&quot;Total number of docs: &quot; + results.getTotal());
for (Map&lt;String,String&gt; document : results.getResults()) {
    System.out.println(document.get(&quot;docId&quot;);
    System.out.println(document.get(&quot;filename&quot;);
    System.out.println(document.get(&quot;createdDate&quot;);
}
For the syntax of the query see Appendix A, PaperTrail Query Language (PQL)
Listing users, groups, routes or contacts (Parties):
// list all parties
client.queryParties(&quot;&quot;);
// list all users
client.queryParties(&quot;&quot;, &quot;user&quot;, null);
//list all groups and routes
client.queryParties(&quot;&quot;, &quot;group,route&quot;, null)
//list only users with access to TestDivision/Cabinet
client.queryParties(&quot;&quot;, &quot;user&quot;, &quot;TestDivision/Cabinet&quot;);
//list all users starting with 'a'
client.queryParties(&quot;a&quot;);
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>Copyright &copy; 2016 Egis Software</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../extra.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
